# 多项式回归
## 案例介绍
在这个案例中，我们将使用多项式回归算法来预测加州地区房屋价格。我们有一些关于加州地区的房屋数据，包括房屋的各种特征（如房间数、附近学校的质量等）以及对应的房屋价格。我们将使用多项式回归模型来学习这些特征和价格之间的关系，并预测新的房屋价格。
## 算法原理
多项式回归是一种回归分析中使用的方法，可以通过拟合一个关于自变量的多项式来预测因变量的数值。与简单线性回归模型只使用一个自变量不同，多项式回归模型可以使用多个自变量来拟合。通过引入高次特征变量，多项式回归模型可以更好地适应非线性关系。

多项式回归模型的一般形式可以表示为：
```math
Y=\theta_0 + \theta_1 X + \theta_2 X^2 +\dots+ \theta_n X^n
```
其中， $Y$ 表示因变量， $X$ 表示自变量， $\theta_0,\theta_1,\dots,\theta_n$ 表示模型的参数， $n$ 表示多项式的阶数
## 公式推导
为了推导多项式的回归模型，我们考虑一个简单的二次多项式模型，假设我们有一组自变量 $X={x_1,x_2,\dots,x_m}$ 和对应的因变量 $Y={y_1,y_2,\dots,y_m}$ ，我们的目标是找到最佳拟合二次多项式曲线。我们的模型形式为：
```math
Y=\theta_0+\theta_1 X+\theta_2 X^2
```
为了找到最佳拟合的参数值 $\theta_0,\theta_1,\theta_2$ , 我们可以使用最小二乘法。我们需要最小化残差平方和 (RSS)：
```math
RSS=\sum\limits_{i=1}^{m}{(y_i-\hat{y_i})^2}
```
其中， $y_i$ 为观测到的因变量值， $\hat{y_i}$ 是根据模型得到的预测值。

对于二次多项式模型，我们可以通过求解以下方程组得到参数值（就是对 $\theta_0,\theta_1, \theta_2$ 求偏导等于0）：
```math
\begin{bmatrix}
m & \sum{X_i} & \sum{X_i^2} \\
\sum{X_i} & \sum{X_i^2} & \sum{X_i^3} \\
\sum{X_i^2} & \sum{X_i^3} & \sum{X_i^4} 
\end{bmatrix}
\begin{bmatrix}
\theta_0 \\
\theta_1 \\
\theta_2 
\end{bmatrix}
=
\begin{bmatrix}
\sum{y_i} \\
\sum{X_iy_i} \\
\sum{X_i^2y_i}
\end{bmatrix}
```
求解该方程组即可得到最佳拟合的参数值。
## 数据集
为了完成这个案例，我们将使用加州房屋数据集。这个数据集包含了加州地区的房屋特征和价格信息。可从sklearn.datasets模块中获取。
## 计算步骤
1. 导入必要的库和数据集
2. 从数据集中加载波士顿房屋数据
3. 提取特征变量和目标变量
4. 使用多项式回归模型进行拟合
5. 预测新的房屋价格
6. 计算模型的性能指标（如均方误差）
7. 绘制原始数据散点图和拟合曲线图